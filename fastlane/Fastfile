lane :release_pod do |options|

  target_version = options[:t]
 
  target_project = options[:p]

  target_repo  = options[:r]

  update_message  = options[:m]
  
  if_pod  = options[:i]

  spec_path = "#{target_project}.podspec"
  
  # git pull
  git_pull(only_tags: true)

  # ç¡®è®¤æ˜¯ master åˆ†æ”¯
  # ensure_git_branch
  # ç¡®è®¤æ˜¯ main åˆ†æ”¯
  ensure_git_branch(
    branch: 'main'
  )
  
  if  if_pod == 'true'
  # ä¿®æ”¹ spec ä¸ºå³å°†å‘å¸ƒçš„ç‰ˆæœ¬
  version_bump_podspec(path: spec_path, version_number: target_version)
  end
  
  # å°†æœ¬åœ°ä»£ç åŠ å…¥æœ¬åœ°ä»“åº“é‡Œ
  git_add(path: '.')
  
  # æäº¤ä¿®æ”¹åˆ°æœ¬åœ°ä»“åº“
  git_commit(path: '.', message: update_message)
  
  if  if_pod == 'true'
  # åœ¨pushä¹‹å‰, æŸ¥çœ‹specæ˜¯å¦é…ç½®æœ‰é—®é¢˜ï¼ŒéªŒè¯ spec æ–‡ä»¶
  pod_lib_lint(verbose: true, allow_warnings: true)
  # ç§æœ‰ä»“éœ€è¦æ·»åŠ éªŒè¯ä»“Sources
  # pod_lib_lint(verbose: true, allow_warnings: true, sources: 'https://github.com/CocoaPods/Specs.git,https://codeup.aliyun.com/6279dbf7487c500c27f5744e/group1/ModuleSpace.git')
  end
  
  UI.message("å‘ç°tag:#{tagName} å·²ç»å­˜åœ¨, å³å°†æ‰§è¡Œ, åˆ é™¤åŠ¨ä½œ ğŸš€")
  
  # æ¨é€masteråˆ†æ”¯çš„ä»£ç åˆ°åç§°ä¸ºoriginçš„è¿œç¨‹ä»“åº“
  push_to_git_remote
  
  # æ£€æŸ¥å¯¹äº tag æ˜¯å¦å·²ç»å­˜åœ¨
  if git_tag_exists(tag: target_version)
      # åˆ é™¤å¯¹åº” tag
      remove_git_tag(tag: target_version)
  end
  
  # æ·»åŠ  tag
  add_git_tag(tag: target_version)
  
  # æäº¤ tag
  push_git_tags
  
  if  if_pod == 'true'
  # # pod trunk push 'spec_path'
  # pod_push(path: spec_path, allow_warnings: true,verbose: true)
    # æ£€æŸ¥æ˜¯å¦ä¼ äº† repo å‚æ•°
    if target_repo
    # pod repo push 'target_repo' 'spec_path'

      pod_push(path: spec_path, repo: target_repo, allow_warnings: true, verbose: true)

    else
    # pod trunk push 'spec_path'

      pod_push(path: spec_path, allow_warnings: true, verbose: true)

    end
  end
end